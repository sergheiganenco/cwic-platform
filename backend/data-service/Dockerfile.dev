# backend/data-service/Dockerfile.dev
FROM node:20-alpine
WORKDIR /app

# 1) copy manifests first
COPY package*.json ./

# 2) lockfile-aware install (only use npm ci when lockfileVersion exists)
RUN if [ -s package-lock.json ] && grep -q '"lockfileVersion"' package-lock.json; then \
    npm ci --no-audit --no-fund; \
    else \
    echo "No valid package-lock.json → using npm install"; \
    npm install --no-audit --no-fund; \
    fi

# 3) app files
COPY . .
EXPOSE 3002
CMD ["npm","run","dev"]
